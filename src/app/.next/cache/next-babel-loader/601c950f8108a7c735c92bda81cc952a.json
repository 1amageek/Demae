{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\nimport \"firebase/auth\";\nexport var usePaymentMethods = () => {\n  _s();\n\n  var [data, isLoading, error] = useFunctions('v1-stripe-paymentMethod-list', {\n    type: 'card'\n  });\n  var methods = data === null || data === void 0 ? void 0 : data.data;\n  return [methods, isLoading, error];\n};\n\n_s(usePaymentMethods, \"75vUt4RK/VRgn+r8o89brn+p4JE=\", false, function () {\n  return [useFunctions];\n});\n\nexport var useFunctions = function useFunctions(query) {\n  _s2();\n\n  var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var waiting = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var {\n    0: state,\n    1: setState\n  } = useState({\n    data: undefined,\n    loading: true\n  });\n\n  var setData = data => {\n    setState({\n      error: undefined,\n      loading: false,\n      data: data\n    });\n  };\n\n  useEffect(() => {\n    var enabled = true;\n\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* () {\n        try {\n          var call = yield firebase.functions().httpsCallable(query);\n          var response = yield call(option);\n          var {\n            result,\n            error\n          } = response.data;\n\n          if (enabled) {\n            if (error) {\n              setState({\n                error: error,\n                loading: false,\n                data: undefined\n              });\n            } else {\n              setState({\n                error: undefined,\n                loading: false,\n                data: result\n              });\n            }\n          }\n        } catch (error) {\n          console.log(error);\n\n          if (enabled) {\n            setState({\n              data: undefined,\n              loading: false,\n              error\n            });\n          }\n        }\n      });\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    setState({\n      data: undefined,\n      loading: true,\n      error: undefined\n    });\n\n    if (!waiting) {\n      fetchData();\n    }\n\n    return () => {\n      enabled = false;\n    };\n  }, [waiting]);\n  return [state.data, state.loading, state.error, setData];\n};\n\n_s2(useFunctions, \"pi8uPLBNvf2ylY9C+gPmNhdDiyQ=\");\n\nexport var useFetchList = function useFetchList(query) {\n  _s3();\n\n  var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var waiting = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var [data, isLoading, error] = useFunctions(query, option, waiting);\n  var {\n    0: list,\n    1: setList\n  } = useState((data === null || data === void 0 ? void 0 : data.data) || []);\n\n  var setData = data => setList(data);\n\n  useEffect(() => {\n    setData((data === null || data === void 0 ? void 0 : data.data) || []);\n  }, [data === null || data === void 0 ? void 0 : data.data.length]);\n  return [list, isLoading, error, setData];\n};\n\n_s3(useFetchList, \"iCt26xe/4izURMO4aK+1QpFEZIo=\", false, function () {\n  return [useFunctions];\n});","map":{"version":3,"sources":["/Users/1amageek/Desktop/Demae/src/app/hooks/stripe/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react'\r\nimport firebase from \"firebase\"\r\nimport \"firebase/firestore\"\r\nimport \"firebase/auth\"\r\nimport { PaymentMethod } from '@stripe/stripe-js';\r\n\r\nexport const usePaymentMethods = (): [PaymentMethod[], boolean, Error | undefined] => {\r\n\tconst [data, isLoading, error] = useFunctions<any>('v1-stripe-paymentMethod-list', { type: 'card' })\r\n\tconst methods = data?.data as PaymentMethod[]\r\n\treturn [methods, isLoading, error]\r\n}\r\n\r\nexport const useFunctions = <T>(query: string, option: any = {}, waiting: boolean = false): [T | undefined, boolean, Error | undefined, (data: T) => void] => {\r\n\r\n\tinterface Prop {\r\n\t\tdata?: T\r\n\t\tloading: boolean\r\n\t\terror?: Error\r\n\t}\r\n\r\n\tconst [state, setState] = useState<Prop>({ data: undefined, loading: true })\r\n\r\n\tconst setData = (data: T) => {\r\n\t\tsetState({\r\n\t\t\terror: undefined,\r\n\t\t\tloading: false,\r\n\t\t\tdata: data\r\n\t\t});\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tlet enabled = true\r\n\t\tconst fetchData = async () => {\r\n\t\t\ttry {\r\n\t\t\t\tconst call = await firebase.functions().httpsCallable(query)\r\n\t\t\t\tconst response = await call(option)\r\n\t\t\t\tconst { result, error } = response.data\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\terror: error,\r\n\t\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\t\tdata: undefined\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\terror: undefined,\r\n\t\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\t\tdata: result\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\tsetState({\r\n\t\t\t\t\t\tdata: undefined,\r\n\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\terror\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tsetState({\r\n\t\t\tdata: undefined,\r\n\t\t\tloading: true,\r\n\t\t\terror: undefined\r\n\t\t})\r\n\t\tif (!waiting) {\r\n\t\t\tfetchData()\r\n\t\t}\r\n\t\treturn () => {\r\n\t\t\tenabled = false\r\n\t\t}\r\n\t}, [waiting])\r\n\treturn [state.data, state.loading, state.error, setData]\r\n};\r\n\r\nexport const useFetchList = <T>(query: string, option: any = {}, waiting: boolean = false): [T[], boolean, Error | undefined, (data: T[]) => void] => {\r\n\tconst [data, isLoading, error] = useFunctions<any>(query, option, waiting)\r\n\tconst [list, setList] = useState<T[]>(data?.data || [] as T[])\r\n\tconst setData = (data: T[]) => setList(data)\r\n\tuseEffect(() => {\r\n\t\tsetData(data?.data || [] as T[])\r\n\t}, [data?.data.length])\r\n\treturn [list, isLoading, error, setData]\r\n}\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}