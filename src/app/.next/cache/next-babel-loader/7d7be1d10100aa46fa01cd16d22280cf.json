{"ast":null,"code":"var _jsxFileName = \"/Users/1amageek/Desktop/Demae/src/app/components/cart/index.tsx\";\nvar __jsx = React.createElement;\nimport React, { useContext } from 'react';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport { useHistory } from 'react-router-dom';\nimport { Box, Paper, Container, Grid, Avatar, Tooltip, IconButton } from '@material-ui/core';\nimport List from '@material-ui/core/List';\nimport ImageIcon from '@material-ui/icons/Image';\nimport Summary from './summary';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport RemoveCircleIcon from '@material-ui/icons/RemoveCircle';\nimport Login from 'components/Login';\nimport Cart from 'models/commerce/Cart';\nimport DataLoading from 'components/DataLoading';\nimport Checkout from 'components/checkout/checkout';\nimport { useAuthUser } from 'hooks/auth';\nimport { useUser, useCart } from 'hooks/commerce';\nimport { CartContext } from 'hooks/commerce';\nimport { useDrawer } from 'components/Drawer';\nconst useStyles = makeStyles(theme => createStyles({\n  avater: {\n    width: theme.spacing(10),\n    height: theme.spacing(10)\n  }\n}));\nexport default (() => {\n  const [auth] = useAuthUser();\n  const {\n    0: cart,\n    1: isLoading\n  } = useContext(CartContext);\n\n  if (isLoading) {\n    return __jsx(Container, {\n      maxWidth: \"sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 16\n      }\n    }, __jsx(DataLoading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 41\n      }\n    }));\n  }\n\n  if (!auth && !isLoading) {\n    return __jsx(Container, {\n      maxWidth: \"sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 16\n      }\n    }, __jsx(Login, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 41\n      }\n    }));\n  }\n\n  if ((cart === null || cart === void 0 ? void 0 : cart.groups.length) === 0) {\n    return __jsx(Container, {\n      maxWidth: \"sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 17\n      }\n    }, __jsx(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      padding: 3,\n      fontSize: 17,\n      fontWeight: 600,\n      color: \"text.secondary\",\n      height: 200,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 5\n      }\n    }, \"There are no items in your cart.\"));\n  }\n\n  return __jsx(Container, {\n    maxWidth: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 13\n    }\n  }, __jsx(Box, {\n    component: \"h2\",\n    fontSize: 20,\n    fontWeight: 600,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 4\n    }\n  }, \"Cart\"), __jsx(Grid, {\n    container: true,\n    spacing: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 4\n    }\n  }, cart === null || cart === void 0 ? void 0 : cart.groups.map(group => {\n    return __jsx(Grid, {\n      item: true,\n      xs: 12,\n      key: group.providedBy,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 17\n      }\n    }, __jsx(CartGroupList, {\n      cartGroup: group,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 8\n      }\n    }));\n  })));\n});\n\nconst CartGroupList = ({\n  cartGroup\n}) => {\n  const history = useHistory();\n  const [showDrawer, onClose] = useDrawer();\n  const subtotal = new Intl.NumberFormat('ja-JP', {\n    style: 'currency',\n    currency: cartGroup.currency\n  }).format(cartGroup.subtotal());\n  const tax = new Intl.NumberFormat('ja-JP', {\n    style: 'currency',\n    currency: cartGroup.currency\n  }).format(cartGroup.tax());\n  return __jsx(Paper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }\n  }, __jsx(List, {\n    dense: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 4\n    }\n  }, cartGroup.items.map(cartItem => {\n    return __jsx(CartItemCell, {\n      key: cartItem.skuReference.path,\n      cartGroup: cartGroup,\n      cartItem: cartItem,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 16\n      }\n    });\n  })), __jsx(Box, {\n    padding: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 4\n    }\n  }, __jsx(Summary, {\n    disabled: false,\n    onClick: e => {\n      e.preventDefault();\n      showDrawer(__jsx(Checkout, {\n        groupID: cartGroup.groupID,\n        onClose: onClose,\n        onComplete: () => {\n          onClose();\n          history.push(`/checkout/${cartGroup.providedBy}/completed`);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 20\n        }\n      }));\n    },\n    items: [{\n      type: 'subtotal',\n      title: 'Subtotal',\n      detail: `${subtotal}`\n    }, {\n      type: 'tax',\n      title: 'Tax',\n      detail: `${tax}`\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 5\n    }\n  })));\n};\n\nconst CartItemCell = ({\n  cartGroup,\n  cartItem\n}) => {\n  const classes = useStyles();\n  const [user] = useUser();\n  const [cart] = useCart();\n\n  const addItem = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (user) {\n      if (cart) {\n        cart.addItem(cartItem, cartGroup.groupID);\n        await cart.save();\n      } else {\n        const cart = new Cart(user.id);\n        cart.addItem(cartItem, cartGroup.groupID);\n        await cart.save();\n      }\n    }\n  };\n\n  const deleteItem = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!cart) {\n      return;\n    }\n\n    cart.subtractItem(cartItem, cartGroup.groupID);\n    await cart.save();\n  };\n\n  const imageURL = cartItem.imageURLs().length > 0 ? cartItem.imageURLs()[0] : undefined;\n  const price = new Intl.NumberFormat('ja-JP', {\n    style: 'currency',\n    currency: cartItem.currency\n  }).format(cartItem.price());\n  const subtotal = new Intl.NumberFormat('ja-JP', {\n    style: 'currency',\n    currency: cartItem.currency\n  }).format(cartItem.subtotal());\n  return __jsx(Box, {\n    display: \"flex\",\n    padding: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, __jsx(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 4\n    }\n  }, __jsx(Avatar, {\n    className: classes.avater,\n    variant: \"rounded\",\n    src: imageURL,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, __jsx(ImageIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 6\n    }\n  }))), __jsx(Box, {\n    flexGrow: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 4\n    }\n  }, __jsx(Box, {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    flexGrow: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }\n  }, __jsx(Box, {\n    mx: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 6\n    }\n  }, __jsx(Box, {\n    flexGrow: 1,\n    fontWeight: 600,\n    fontSize: 18,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }\n  }, cartItem.name, __jsx(Box, {\n    fontSize: 16,\n    fontWeight: 400,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 8\n    }\n  }, cartItem.caption), __jsx(Box, {\n    fontSize: 16,\n    fontWeight: 400,\n    color: \"text.secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 8\n    }\n  }, price))), __jsx(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 6\n    }\n  }, __jsx(Box, {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    fontSize: 18,\n    fontWeight: 500,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }\n  }, subtotal), __jsx(Box, {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\",\n    mx: 0,\n    my: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }, __jsx(Tooltip, {\n    title: \"Remove\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 8\n    }\n  }, __jsx(IconButton, {\n    onClick: deleteItem,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }\n  }, __jsx(RemoveCircleIcon, {\n    color: \"inherit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 10\n    }\n  }))), __jsx(Box, {\n    fontWeight: 600,\n    fontSize: 20,\n    mx: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 8\n    }\n  }, cartItem.quantity), __jsx(Tooltip, {\n    title: \"Add\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 8\n    }\n  }, __jsx(IconButton, {\n    onClick: addItem,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, __jsx(AddCircleIcon, {\n    color: \"inherit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 10\n    }\n  }))))))));\n};","map":{"version":3,"sources":["/Users/1amageek/Desktop/Demae/src/app/components/cart/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\r\nimport { createStyles, Theme, makeStyles } from '@material-ui/core/styles';\r\nimport { useHistory } from 'react-router-dom'\r\nimport { Box, Paper, Container, Grid, ListItemAvatar, Avatar, Tooltip, IconButton } from '@material-ui/core';\r\nimport List from '@material-ui/core/List';\r\nimport ImageIcon from '@material-ui/icons/Image';\r\nimport Summary from './summary'\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport RemoveCircleIcon from '@material-ui/icons/RemoveCircle';\r\nimport Login from 'components/Login'\r\nimport Cart, { CartGroup, CartItem } from 'models/commerce/Cart'\r\nimport DataLoading from 'components/DataLoading';\r\nimport Checkout from 'components/checkout/checkout'\r\nimport { useAuthUser } from 'hooks/auth'\r\nimport { useUser, useCart } from 'hooks/commerce';\r\nimport { CartContext } from 'hooks/commerce'\r\nimport { useDrawer } from 'components/Drawer';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n\tcreateStyles({\r\n\t\tavater: {\r\n\t\t\twidth: theme.spacing(10),\r\n\t\t\theight: theme.spacing(10),\r\n\t\t}\r\n\t}),\r\n);\r\n\r\nexport default () => {\r\n\tconst [auth] = useAuthUser()\r\n\tconst [cart, isLoading] = useContext(CartContext)\r\n\r\n\tif (isLoading) {\r\n\t\treturn <Container maxWidth='sm'><DataLoading /></Container>\r\n\t}\r\n\r\n\tif (!auth && !isLoading) {\r\n\t\treturn <Container maxWidth='sm'><Login /></Container>\r\n\t}\r\n\r\n\tif (cart?.groups.length === 0) {\r\n\t\treturn (\r\n\t\t\t<Container maxWidth='sm'>\r\n\t\t\t\t<Box display='flex' justifyContent='center' alignItems='center' padding={3} fontSize={17} fontWeight={600} color='text.secondary' height={200}>\r\n\t\t\t\t\tThere are no items in your cart.\r\n\t\t\t\t</Box>\r\n\t\t\t</Container>\r\n\t\t)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Container maxWidth='sm'>\r\n\t\t\t<Box component=\"h2\" fontSize={20} fontWeight={600}>Cart</Box>\r\n\t\t\t<Grid container spacing={2}>\r\n\t\t\t\t{cart?.groups.map(group => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Grid item xs={12} key={group.providedBy}>\r\n\t\t\t\t\t\t\t<CartGroupList cartGroup={group} />\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</Grid>\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\nconst CartGroupList = ({ cartGroup }: { cartGroup: CartGroup }) => {\r\n\r\n\tconst history = useHistory()\r\n\tconst [showDrawer, onClose] = useDrawer()\r\n\r\n\tconst subtotal = new Intl.NumberFormat('ja-JP', { style: 'currency', currency: cartGroup.currency }).format(cartGroup.subtotal())\r\n\tconst tax = new Intl.NumberFormat('ja-JP', { style: 'currency', currency: cartGroup.currency }).format(cartGroup.tax())\r\n\r\n\treturn (\r\n\t\t<Paper>\r\n\t\t\t<List dense>\r\n\t\t\t\t{cartGroup.items.map(cartItem => {\r\n\t\t\t\t\treturn <CartItemCell key={cartItem.skuReference!.path} cartGroup={cartGroup} cartItem={cartItem} />\r\n\t\t\t\t})}\r\n\t\t\t</List>\r\n\t\t\t<Box padding={2}>\r\n\t\t\t\t<Summary\r\n\t\t\t\t\tdisabled={false}\r\n\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\tshowDrawer(\r\n\t\t\t\t\t\t\t<Checkout groupID={cartGroup.groupID}\r\n\t\t\t\t\t\t\t\tonClose={onClose}\r\n\t\t\t\t\t\t\t\tonComplete={() => {\r\n\t\t\t\t\t\t\t\t\tonClose()\r\n\t\t\t\t\t\t\t\t\thistory.push(`/checkout/${cartGroup.providedBy}/completed`)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\titems={[{\r\n\t\t\t\t\t\ttype: 'subtotal',\r\n\t\t\t\t\t\ttitle: 'Subtotal',\r\n\t\t\t\t\t\tdetail: `${subtotal}`\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'tax',\r\n\t\t\t\t\t\ttitle: 'Tax',\r\n\t\t\t\t\t\tdetail: `${tax}`\r\n\t\t\t\t\t}]} />\r\n\t\t\t</Box>\r\n\t\t</Paper>\r\n\t)\r\n}\r\n\r\nconst CartItemCell = ({ cartGroup, cartItem }: { cartGroup: CartGroup, cartItem: CartItem }) => {\r\n\r\n\tconst classes = useStyles()\r\n\tconst [user] = useUser()\r\n\tconst [cart] = useCart()\r\n\r\n\tconst addItem = async (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tevent.stopPropagation()\r\n\t\tif (user) {\r\n\t\t\tif (cart) {\r\n\t\t\t\tcart.addItem(cartItem, cartGroup.groupID)\r\n\t\t\t\tawait cart.save()\r\n\t\t\t} else {\r\n\t\t\t\tconst cart = new Cart(user.id)\r\n\t\t\t\tcart.addItem(cartItem, cartGroup.groupID)\r\n\t\t\t\tawait cart.save()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst deleteItem = async (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tevent.stopPropagation()\r\n\t\tif (!cart) { return }\r\n\t\tcart.subtractItem(cartItem, cartGroup.groupID)\r\n\t\tawait cart.save()\r\n\t}\r\n\r\n\tconst imageURL = (cartItem.imageURLs().length > 0) ? cartItem.imageURLs()[0] : undefined\r\n\tconst price = new Intl.NumberFormat('ja-JP', { style: 'currency', currency: cartItem.currency }).format(cartItem.price())\r\n\tconst subtotal = new Intl.NumberFormat('ja-JP', { style: 'currency', currency: cartItem.currency }).format(cartItem.subtotal())\r\n\r\n\treturn (\r\n\t\t<Box display='flex' padding={2}>\r\n\t\t\t<Box>\r\n\t\t\t\t<Avatar className={classes.avater} variant=\"rounded\" src={imageURL}>\r\n\t\t\t\t\t<ImageIcon />\r\n\t\t\t\t</Avatar>\r\n\t\t\t</Box>\r\n\t\t\t<Box flexGrow={1}>\r\n\t\t\t\t<Box display=\"flex\" justifyContent=\"space-between\" flexGrow={1}>\r\n\t\t\t\t\t<Box mx={2}>\r\n\t\t\t\t\t\t<Box flexGrow={1} fontWeight={600} fontSize={18}>\r\n\t\t\t\t\t\t\t{cartItem.name}\r\n\t\t\t\t\t\t\t<Box fontSize={16} fontWeight={400}>\r\n\t\t\t\t\t\t\t\t{cartItem.caption}\r\n\t\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t\t<Box fontSize={16} fontWeight={400} color='text.secondary'>\r\n\t\t\t\t\t\t\t\t{price}\r\n\t\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t\t<Box>\r\n\t\t\t\t\t\t<Box display=\"flex\" justifyContent=\"flex-end\" fontSize={18} fontWeight={500} >\r\n\t\t\t\t\t\t\t{subtotal}\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t<Box display=\"flex\" justifyContent=\"flex-end\" alignItems=\"center\" mx={0} my={0}>\r\n\t\t\t\t\t\t\t<Tooltip title='Remove'>\r\n\t\t\t\t\t\t\t\t<IconButton onClick={deleteItem}>\r\n\t\t\t\t\t\t\t\t\t<RemoveCircleIcon color='inherit' />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t<Box fontWeight={600} fontSize={20} mx={1}>\r\n\t\t\t\t\t\t\t\t{cartItem.quantity}\r\n\t\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t\t<Tooltip title='Add'>\r\n\t\t\t\t\t\t\t\t<IconButton onClick={addItem}>\r\n\t\t\t\t\t\t\t\t\t<AddCircleIcon color='inherit' />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t</Box>\r\n\t\t\t</Box>\r\n\t\t</Box>\r\n\t)\r\n}\r\n\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}