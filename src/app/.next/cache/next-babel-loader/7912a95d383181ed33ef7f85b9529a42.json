{"ast":null,"code":"var _jsxFileName = \"/Users/1amageek/Desktop/Demae/src/app/components/provider/workflow/form/index.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport Input, { useInput } from 'components/Input';\nimport Provider, { Role } from 'models/commerce/Provider';\nimport User from 'models/commerce/User';\nimport { SupportedCurrencies } from 'common/Currency';\nimport Button from '@material-ui/core/Button';\nimport Box from '@material-ui/core/Toolbar';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableRow from '@material-ui/core/TableRow';\nimport Select, { useSelect } from 'components/Select';\nimport { useProcessing } from 'components/Processing';\nimport { Batch } from '@1amageek/ballcap';\nimport { useDialog } from 'components/Dialog';\nimport { useAuthUser } from 'hooks/auth';\nconst useStyles = makeStyles(theme => createStyles({\n  box: {\n    padding: theme.spacing(2),\n    backgroundColor: '#fafafa'\n  },\n  bottomBox: {\n    padding: theme.spacing(2),\n    display: 'flex',\n    justifyContent: 'flex-end'\n  },\n  input: {\n    backgroundColor: '#fff'\n  },\n  cell: {\n    borderBottom: 'none',\n    padding: theme.spacing(1)\n  },\n  cellStatus: {\n    borderBottom: 'none',\n    padding: theme.spacing(1),\n    width: '48px'\n  },\n  cellStatusBox: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center'\n  }\n}));\nexport default (({\n  country,\n  onCallback\n}) => {\n  const classes = useStyles();\n  const [auth] = useAuthUser();\n  const [setProcessing] = useProcessing();\n  const [setDialog] = useDialog();\n  const name = useInput(\"\");\n  const currencyInitValue = country === \"JP\" ? \"JPY\" : \"USD\";\n  const defaultCurrency = useSelect({\n    initValue: currencyInitValue,\n    inputProps: {\n      menu: SupportedCurrencies.map(currency => {\n        return {\n          label: `${currency.code} (${currency.name})`,\n          value: currency.code\n        };\n      })\n    }\n  });\n\n  const onSubmit = async event => {\n    event.preventDefault();\n    if (!auth) return;\n    const uid = auth.uid;\n    setProcessing(true);\n    const provider = new Provider(uid);\n    provider.name = name.value;\n    provider.country = country;\n    provider.defaultCurrency = defaultCurrency.value;\n    const user = new User(uid);\n    const provierRole = new Role(provider.members.collectionReference.doc(user.id));\n\n    try {\n      const batch = new Batch();\n      batch.save(provider);\n      batch.save(provierRole);\n      await batch.commit();\n\n      if (onCallback) {\n        onCallback(true);\n      }\n    } catch (error) {\n      console.error(error);\n      setDialog('Error', 'Creation of provider failed. Please try again with good communication conditions.', [{\n        title: 'OK',\n        autoFocus: true\n      }]);\n    }\n\n    setProcessing(false);\n  };\n\n  return __jsx(\"form\", {\n    autoComplete: \"off\",\n    onSubmit: onSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, __jsx(Box, {\n    className: classes.box,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 4\n    }\n  }, __jsx(Table, {\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }\n  }, __jsx(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 6\n    }\n  }, __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, __jsx(TableCell, {\n    className: classes.cellStatus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 8\n    }\n  }), __jsx(TableCell, {\n    className: classes.cell,\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 8\n    }\n  }, \"Shop name\"), __jsx(TableCell, {\n    className: classes.cell,\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 8\n    }\n  }, __jsx(Input, _extends({\n    className: classes.input,\n    label: \"name\",\n    variant: \"outlined\",\n    margin: \"dense\",\n    size: \"small\",\n    required: true\n  }, name, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  })))), __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }\n  }, __jsx(TableCell, {\n    className: classes.cellStatus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 8\n    }\n  }), __jsx(TableCell, {\n    className: classes.cell,\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 8\n    }\n  }, \"Currency\"), __jsx(TableCell, {\n    className: classes.cell,\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 8\n    }\n  }, __jsx(Select, _extends({}, defaultCurrency, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }))))))), __jsx(Box, {\n    className: classes.bottomBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 4\n    }\n  }, __jsx(Button, {\n    onClick: () => {\n      onCallback(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }\n  }, \"Back\"), __jsx(Button, {\n    fullWidth: true,\n    variant: \"contained\",\n    size: \"large\",\n    color: \"primary\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }\n  }, \"Save\")));\n});","map":{"version":3,"sources":["/Users/1amageek/Desktop/Demae/src/app/components/provider/workflow/form/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useState, useContext } from 'react';\r\nimport { createStyles, Theme, makeStyles } from '@material-ui/core/styles';\r\nimport Input, { useInput } from 'components/Input';\r\nimport Provider, { Role } from 'models/commerce/Provider';\r\nimport User from 'models/commerce/User';\r\nimport { SupportedCurrencies, CurrencyCode } from 'common/Currency'\r\nimport { SupportedCountries, CountryCode } from 'common/Country';\r\nimport Button from '@material-ui/core/Button';\r\nimport Box from '@material-ui/core/Toolbar';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Select, { useSelect } from 'components/Select'\r\nimport { useProcessing } from 'components/Processing'\r\nimport { Batch } from '@1amageek/ballcap';\r\nimport { useDialog } from 'components/Dialog'\r\nimport { useAuthUser } from 'hooks/auth';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n\tcreateStyles({\r\n\t\tbox: {\r\n\t\t\tpadding: theme.spacing(2),\r\n\t\t\tbackgroundColor: '#fafafa'\r\n\t\t},\r\n\t\tbottomBox: {\r\n\t\t\tpadding: theme.spacing(2),\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tjustifyContent: 'flex-end'\r\n\t\t},\r\n\t\tinput: {\r\n\t\t\tbackgroundColor: '#fff'\r\n\t\t},\r\n\t\tcell: {\r\n\t\t\tborderBottom: 'none',\r\n\t\t\tpadding: theme.spacing(1),\r\n\t\t},\r\n\t\tcellStatus: {\r\n\t\t\tborderBottom: 'none',\r\n\t\t\tpadding: theme.spacing(1),\r\n\t\t\twidth: '48px',\r\n\t\t},\r\n\t\tcellStatusBox: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tjustifyContent: 'center',\r\n\t\t\talignItems: 'center'\r\n\t\t}\r\n\t})\r\n)\r\n\r\nexport default ({ country, onCallback }: { country: CountryCode, onCallback: (next: boolean) => void }) => {\r\n\r\n\tconst classes = useStyles()\r\n\tconst [auth] = useAuthUser()\r\n\tconst [setProcessing] = useProcessing()\r\n\tconst [setDialog] = useDialog()\r\n\tconst name = useInput(\"\")\r\n\tconst currencyInitValue = (country === \"JP\") ? \"JPY\" : \"USD\"\r\n\tconst defaultCurrency = useSelect({\r\n\t\tinitValue: currencyInitValue,\r\n\t\tinputProps: {\r\n\t\t\tmenu: SupportedCurrencies.map(currency => {\r\n\t\t\t\treturn { label: `${currency.code} (${currency.name})`, value: currency.code }\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\r\n\tconst onSubmit = async (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tif (!auth) return;\r\n\t\tconst uid = auth.uid\r\n\t\tsetProcessing(true)\r\n\t\tconst provider = new Provider(uid)\r\n\t\tprovider.name = name.value\r\n\t\tprovider.country = country as CountryCode\r\n\t\tprovider.defaultCurrency = defaultCurrency.value as CurrencyCode\r\n\t\tconst user = new User(uid)\r\n\t\tconst provierRole = new Role(provider.members.collectionReference.doc(user.id))\r\n\t\ttry {\r\n\t\t\tconst batch = new Batch()\r\n\t\t\tbatch.save(provider)\r\n\t\t\tbatch.save(provierRole)\r\n\t\t\tawait batch.commit()\r\n\t\t\tif (onCallback) {\r\n\t\t\t\tonCallback(true)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error)\r\n\t\t\tsetDialog('Error', 'Creation of provider failed. Please try again with good communication conditions.', [{\r\n\t\t\t\ttitle: 'OK',\r\n\t\t\t\tautoFocus: true\r\n\t\t\t}])\r\n\t\t}\r\n\t\tsetProcessing(false)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<form autoComplete='off' onSubmit={onSubmit}>\r\n\t\t\t<Box className={classes.box}>\r\n\t\t\t\t<Table size='small'>\r\n\t\t\t\t\t<TableBody>\r\n\t\t\t\t\t\t<TableRow>\r\n\t\t\t\t\t\t\t<TableCell className={classes.cellStatus}></TableCell>\r\n\t\t\t\t\t\t\t<TableCell className={classes.cell} align='right'>Shop name</TableCell>\r\n\t\t\t\t\t\t\t<TableCell className={classes.cell} align='left'>\r\n\t\t\t\t\t\t\t\t<Input className={classes.input} label='name' variant='outlined' margin='dense' size='small' required {...name} />\r\n\t\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t<TableRow>\r\n\t\t\t\t\t\t\t<TableCell className={classes.cellStatus}></TableCell>\r\n\t\t\t\t\t\t\t<TableCell className={classes.cell} align='right'>Currency</TableCell>\r\n\t\t\t\t\t\t\t<TableCell className={classes.cell} align='left'>\r\n\t\t\t\t\t\t\t\t<Select {...defaultCurrency} />\r\n\t\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t</TableBody>\r\n\t\t\t\t</Table>\r\n\t\t\t</Box>\r\n\t\t\t<Box className={classes.bottomBox} >\r\n\t\t\t\t<Button onClick={() => {\r\n\t\t\t\t\tonCallback(false)\r\n\t\t\t\t}}>Back</Button>\r\n\t\t\t\t<Button fullWidth variant='contained' size='large' color='primary' type='submit'>\r\n\t\t\t\t\tSave\r\n\t\t\t\t</Button>\r\n\t\t\t</Box>\r\n\t\t</form>\r\n\t)\r\n}\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}