{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$(),\n    _jsxFileName = \"/Users/1amageek/Desktop/Demae/src/app/hooks/commerce/index.tsx\",\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$(),\n    _s6 = $RefreshSig$(),\n    _s7 = $RefreshSig$(),\n    _s8 = $RefreshSig$(),\n    _s9 = $RefreshSig$(),\n    _s10 = $RefreshSig$(),\n    _s11 = $RefreshSig$(),\n    _s12 = $RefreshSig$(),\n    _s13 = $RefreshSig$(),\n    _s14 = $RefreshSig$(),\n    _s15 = $RefreshSig$(),\n    _s16 = $RefreshSig$(),\n    _s17 = $RefreshSig$(),\n    _s18 = $RefreshSig$(),\n    _s19 = $RefreshSig$(),\n    _s20 = $RefreshSig$(),\n    _s21 = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useState, createContext, useContext } from 'react';\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\nimport \"firebase/auth\";\nimport { useDocumentListen, useDataSourceListen } from '../firestore';\nimport Provider, { Role } from 'models/commerce/Provider';\nimport Product from 'models/commerce/Product';\nimport SKU from 'models/commerce/SKU';\nimport Cart from 'models/commerce/Cart';\nimport User from 'models/commerce/User';\nimport Shipping from 'models/commerce/Shipping';\nimport Order from 'models/commerce/Order';\nimport { AuthContext } from '../auth';\n\nvar _useAdmin = () => {\n  _s();\n\n  var {\n    0: state,\n    1: setState\n  } = useState({\n    loading: true\n  });\n  useEffect(() => {\n    var enabled = true;\n    var listener = firebase.auth().onIdTokenChanged( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (auth) {\n        if (auth) {\n          var result = yield auth === null || auth === void 0 ? void 0 : auth.getIdTokenResult();\n\n          if (enabled) {\n            var adminID = result.claims.admin;\n\n            if (adminID) {\n              var user = new User(auth.uid);\n              var snapshot = yield user.providers.collectionReference.doc(adminID).get();\n              var role = Role.fromSnapshot(snapshot);\n              setState({\n                data: role,\n                loading: false,\n                error: undefined\n              });\n            } else {\n              setState({\n                data: undefined,\n                loading: false,\n                error: undefined\n              });\n            }\n          }\n        } else {\n          if (enabled) {\n            setState({\n              data: undefined,\n              loading: false,\n              error: undefined\n            });\n          }\n        }\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), error => {\n      if (enabled) {\n        setState({\n          data: undefined,\n          loading: false,\n          error: error\n        });\n      }\n    });\n    return () => {\n      enabled = false;\n      listener();\n    };\n  }, []);\n  return [state.data, state.loading, state.error];\n};\n\n_s(_useAdmin, \"8gpkCwuelJ9NGSV9NiszyzlC59k=\");\n\nexport var AdminContext = createContext([undefined, true, undefined]);\nexport var AdminProvider = (_ref2) => {\n  var {\n    children\n  } = _ref2;\n\n  var [auth, isLoading, error] = _useAdmin();\n\n  return __jsx(AdminContext.Provider, {\n    value: [auth, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n_c = AdminProvider;\nexport var useAdmin = () => {\n  _s2();\n\n  return useContext(AdminContext);\n}; // Admin\n\n_s2(useAdmin, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport var AdminProviderContext = createContext([undefined, true, undefined]);\nexport var AdminProviderProvider = (_ref3) => {\n  _s3();\n\n  var {\n    children\n  } = _ref3;\n  var [auth, waiting] = useAdmin();\n  var [data, isLoading, error] = useDocumentListen(Provider, (auth === null || auth === void 0 ? void 0 : auth.id) ? new Provider(auth.id).documentReference : undefined, waiting);\n  return __jsx(AdminProviderContext.Provider, {\n    value: [data, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s3(AdminProviderProvider, \"UGSokUIw7UKSsCKm1dLNgsm8Ra8=\", false, function () {\n  return [useAdmin, useDocumentListen];\n});\n\n_c2 = AdminProviderProvider;\nexport var AdminProviderProductContext = createContext([undefined, true, undefined]);\nexport var AdminProviderProductProvider = (_ref4) => {\n  _s4();\n\n  var {\n    id,\n    children\n  } = _ref4;\n  var {\n    0: provider,\n    1: waiting\n  } = useContext(AdminProviderContext);\n  var documentReference = provider && id ? provider === null || provider === void 0 ? void 0 : provider.products.collectionReference.doc(id) : undefined;\n  var [data, isLoading, error] = useDocumentListen(Product, documentReference, waiting);\n  return __jsx(AdminProviderProductContext.Provider, {\n    value: [data, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s4(AdminProviderProductProvider, \"jpKqTUqviF4PFfJEjLXeQgRo2kM=\", false, function () {\n  return [useDocumentListen];\n});\n\n_c3 = AdminProviderProductProvider;\nexport var AdminProviderProductSKUContext = createContext([undefined, true, undefined]);\nexport var AdminProviderProductSKUProvider = (_ref5) => {\n  _s5();\n\n  var {\n    id,\n    children\n  } = _ref5;\n  var {\n    0: product,\n    1: waiting\n  } = useContext(AdminProviderProductContext);\n  var documentReference = product && id ? product.skus.collectionReference.doc(id) : undefined;\n  var [data, isLoading, error] = useDocumentListen(SKU, documentReference, waiting);\n  return __jsx(AdminProviderProductSKUContext.Provider, {\n    value: [data, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s5(AdminProviderProductSKUProvider, \"SusKctu3w6ArawiksLIwz+sQoEs=\", false, function () {\n  return [useDocumentListen];\n});\n\n_c4 = AdminProviderProductSKUProvider;\nexport var AdminProviderOrderContext = createContext([undefined, true, undefined]);\nexport var AdminProviderOrderProvider = (_ref6) => {\n  _s6();\n\n  var {\n    id,\n    children\n  } = _ref6;\n  var {\n    0: provider,\n    1: waiting\n  } = useContext(AdminProviderContext);\n  var documentReference = provider && id ? provider.orders.collectionReference.doc(id) : undefined;\n  var [data, isLoading, error] = useDocumentListen(Order, documentReference, waiting);\n  return __jsx(AdminProviderOrderContext.Provider, {\n    value: [data, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s6(AdminProviderOrderProvider, \"jpKqTUqviF4PFfJEjLXeQgRo2kM=\", false, function () {\n  return [useDocumentListen];\n});\n\n_c5 = AdminProviderOrderProvider;\nexport var useAdminProvider = () => {\n  _s7();\n\n  return useContext(AdminProviderContext);\n};\n\n_s7(useAdminProvider, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport var useAdminProviderProducts = () => {\n  _s8();\n\n  var [provider, waiting] = useAdminProvider();\n  var collectionReference = provider ? provider.products.collectionReference : undefined;\n  return useDataSourceListen(Product, {\n    path: collectionReference === null || collectionReference === void 0 ? void 0 : collectionReference.path\n  }, waiting);\n};\n\n_s8(useAdminProviderProducts, \"Dt7pCQC56WZVqghkpCWGqaIrvaY=\", false, function () {\n  return [useAdminProvider, useDataSourceListen];\n});\n\nexport var useAdminProviderProduct = () => {\n  _s9();\n\n  return useContext(AdminProviderProductContext);\n};\n\n_s9(useAdminProviderProduct, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport var useAdminProviderProductSKUs = id => {\n  _s10();\n\n  var [provider, waiting] = useAdminProvider();\n  var collectionReference = provider && id ? provider.products.collectionReference.doc(id).collection('skus') : undefined;\n  return useDataSourceListen(SKU, {\n    path: collectionReference === null || collectionReference === void 0 ? void 0 : collectionReference.path\n  }, waiting);\n};\n\n_s10(useAdminProviderProductSKUs, \"Dt7pCQC56WZVqghkpCWGqaIrvaY=\", false, function () {\n  return [useAdminProvider, useDataSourceListen];\n});\n\nexport var useAdminProviderOrders = () => {\n  _s11();\n\n  var [provider, waiting] = useAdminProvider();\n  var collectionReference = provider ? provider.orders.collectionReference : undefined;\n  return useDataSourceListen(Order, {\n    path: collectionReference === null || collectionReference === void 0 ? void 0 : collectionReference.path\n  }, waiting);\n};\n\n_s11(useAdminProviderOrders, \"Dt7pCQC56WZVqghkpCWGqaIrvaY=\", false, function () {\n  return [useAdminProvider, useDataSourceListen];\n});\n\nexport var useAdminProviderProductSKU = (productID, skuID) => {\n  _s12();\n\n  var [provider, waiting] = useAdminProvider();\n  var documentReference = provider && productID && skuID ? provider.products.doc(productID, Product).skus.collectionReference.doc(skuID) : undefined;\n  return useDocumentListen(SKU, documentReference, waiting);\n};\n\n_s12(useAdminProviderProductSKU, \"HwwqINFg4lwWajgEZVcnF8LXqTM=\", false, function () {\n  return [useAdminProvider, useDocumentListen];\n});\n\nexport var useAdminProviderOrder = id => {\n  _s13();\n\n  var [provider, waiting] = useAdminProvider();\n  var documentReference = provider && id ? provider.orders.collectionReference.doc(id) : undefined;\n  return useDocumentListen(Order, documentReference, waiting);\n}; // User\n\n_s13(useAdminProviderOrder, \"HwwqINFg4lwWajgEZVcnF8LXqTM=\", false, function () {\n  return [useAdminProvider, useDocumentListen];\n});\n\nexport var UserContext = createContext([undefined, true, undefined]);\nexport var UserProvider = (_ref7) => {\n  _s14();\n\n  var {\n    children\n  } = _ref7;\n  var {\n    0: auth,\n    1: waiting\n  } = useContext(AuthContext);\n  var [user, isLoading, error] = useDocumentListen(User, (auth === null || auth === void 0 ? void 0 : auth.uid) ? new User(auth.uid).documentReference : undefined, waiting);\n  return __jsx(UserContext.Provider, {\n    value: [user, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s14(UserProvider, \"dnZGl4ayj3M2/jWJ86pxCu8lskc=\", false, function () {\n  return [useDocumentListen];\n});\n\n_c6 = UserProvider;\nexport var RolesContext = createContext([[], true, undefined]);\nexport var RolesProvider = (_ref8) => {\n  _s15();\n\n  var {\n    children\n  } = _ref8;\n  var {\n    0: user,\n    1: waiting\n  } = useContext(UserContext);\n  var [roles, isLoading, error] = useDataSourceListen(Role, user ? {\n    path: user.providers.collectionReference.path\n  } : undefined, waiting);\n  return __jsx(RolesContext.Provider, {\n    value: [roles, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s15(RolesProvider, \"OzXCo4NCzfpf+qKQqZkCajGuq2w=\", false, function () {\n  return [useDataSourceListen];\n});\n\n_c7 = RolesProvider;\nexport var CartContext = createContext([undefined, true, undefined]);\nexport var CartProvider = (_ref9) => {\n  _s16();\n\n  var {\n    children\n  } = _ref9;\n  var {\n    0: auth,\n    1: waiting\n  } = useContext(AuthContext);\n  var [cart, isLoading, error] = useDocumentListen(Cart, (auth === null || auth === void 0 ? void 0 : auth.uid) ? new Cart(auth.uid).documentReference : undefined, waiting);\n  return __jsx(CartContext.Provider, {\n    value: [cart, isLoading, error],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 12\n    }\n  }, \" \", children, \" \");\n};\n\n_s16(CartProvider, \"GNErSf7+zRlvgYLgrU6Ba6ea5hE=\", false, function () {\n  return [useDocumentListen];\n});\n\n_c8 = CartProvider;\nexport var useUserShipping = id => {\n  _s17();\n\n  var {\n    0: auth,\n    1: isAuthLoading\n  } = useContext(AuthContext);\n  var collectionReference = new User(auth === null || auth === void 0 ? void 0 : auth.uid).shippingAddresses.collectionReference;\n  var {\n    0: ref\n  } = useState(id ? collectionReference.doc(id) : collectionReference.doc());\n  var [shipping, isLoading, error] = useDocumentListen(Shipping, ref, isAuthLoading);\n  return [shipping, isLoading, error];\n};\n\n_s17(useUserShipping, \"/PWMfrrc7zzM1/EXP0azMafZ5To=\", false, function () {\n  return [useDocumentListen];\n});\n\nexport var useUserShippingAddresses = () => {\n  _s18();\n\n  var {\n    0: auth,\n    1: isAuthLoading\n  } = useContext(AuthContext);\n  var collectionReference = new User(auth === null || auth === void 0 ? void 0 : auth.uid).shippingAddresses.collectionReference;\n  var [data, isLoading, error] = useDataSourceListen(Shipping, {\n    path: collectionReference === null || collectionReference === void 0 ? void 0 : collectionReference.path\n  }, isAuthLoading);\n  return [data, isLoading, error];\n};\n\n_s18(useUserShippingAddresses, \"4YDo6LV2L6ZIUCEPpH0R1ll2JXY=\", false, function () {\n  return [useDataSourceListen];\n});\n\nexport var useCart = () => {\n  _s19();\n\n  return useContext(CartContext);\n};\n\n_s19(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport var useUser = () => {\n  _s20();\n\n  return useContext(UserContext);\n};\n\n_s20(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport var useRoles = () => {\n  _s21();\n\n  return useContext(RolesContext);\n}; // Provider\n// export const ProviderContext = createContext<[Provider | undefined, boolean, Error | undefined]>([undefined, true, undefined])\n// export const ProviderProvider = ({ id, children }: { id?: string, children: any }) => {\n// \tconst [provider, isLoading, error] = useDocumentListen<Provider>(Provider, id ? new Provider(id).documentReference : undefined)\n// \treturn <ProviderContext.Provider value={[provider, isLoading, error]}> {children} </ProviderContext.Provider>\n// }\n// export const ProviderProductContext = createContext<[Product | undefined, boolean, Error | undefined]>([undefined, true, undefined])\n// export const ProviderProductProvider = ({ id, children }: { id?: string, children: any }) => {\n// \tconst [provider, waiting] = useContext(ProviderContext)\n// \tconst [product, isLoading, error] = useDocumentListen<Product>(Product, id ? provider?.products.collectionReference.doc(id) : undefined, waiting)\n// \treturn <ProviderProductContext.Provider value={[product, isLoading, error]}> {children} </ProviderProductContext.Provider>\n// }\n// export const useProvider = (): [Provider | undefined, boolean, Error | undefined] => {\n// \treturn useContext(ProviderContext)\n// }\n// export const useProviderProduct = (): [Product | undefined, boolean, Error | undefined] => {\n// \treturn useContext(ProviderProductContext)\n// }\n\n_s21(useRoles, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8;\n\n$RefreshReg$(_c, \"AdminProvider\");\n$RefreshReg$(_c2, \"AdminProviderProvider\");\n$RefreshReg$(_c3, \"AdminProviderProductProvider\");\n$RefreshReg$(_c4, \"AdminProviderProductSKUProvider\");\n$RefreshReg$(_c5, \"AdminProviderOrderProvider\");\n$RefreshReg$(_c6, \"UserProvider\");\n$RefreshReg$(_c7, \"RolesProvider\");\n$RefreshReg$(_c8, \"CartProvider\");","map":{"version":3,"sources":["/Users/1amageek/Desktop/Demae/src/app/hooks/commerce/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useEffect, useState, createContext, useContext } from 'react'\r\nimport firebase from \"firebase\"\r\nimport \"firebase/firestore\"\r\nimport \"firebase/auth\"\r\nimport { useDocumentListen, useDataSourceListen } from '../firestore'\r\nimport Provider, { Role } from 'models/commerce/Provider'\r\nimport Product from 'models/commerce/Product'\r\nimport SKU from 'models/commerce/SKU'\r\nimport Cart from 'models/commerce/Cart'\r\nimport User from 'models/commerce/User'\r\nimport Shipping from 'models/commerce/Shipping'\r\nimport Order from 'models/commerce/Order'\r\nimport { AuthContext } from '../auth'\r\n\r\nconst _useAdmin = (): [Role | undefined, boolean, firebase.auth.Error?] => {\r\n\tinterface Prop {\r\n\t\tdata?: Role\r\n\t\tloading: boolean\r\n\t\terror?: firebase.auth.Error\r\n\t}\r\n\tconst [state, setState] = useState<Prop>({ loading: true })\r\n\tuseEffect(() => {\r\n\t\tlet enabled = true\r\n\t\tlet listener = firebase.auth().onIdTokenChanged(async (auth) => {\r\n\t\t\tif (auth) {\r\n\t\t\t\tconst result = await auth?.getIdTokenResult()\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\tconst adminID = result.claims.admin\r\n\t\t\t\t\tif (adminID) {\r\n\t\t\t\t\t\tconst user: User = new User(auth.uid)\r\n\t\t\t\t\t\tconst snapshot = await user.providers.collectionReference.doc(adminID).get()\r\n\t\t\t\t\t\tconst role: Role = Role.fromSnapshot(snapshot)\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tdata: role,\r\n\t\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\t\terror: undefined\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tdata: undefined,\r\n\t\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\t\terror: undefined\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\tsetState({\r\n\t\t\t\t\t\tdata: undefined,\r\n\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\terror: undefined\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, (error) => {\r\n\t\t\tif (enabled) {\r\n\t\t\t\tsetState({\r\n\t\t\t\t\tdata: undefined,\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t\terror: error\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn () => {\r\n\t\t\tenabled = false\r\n\t\t\tlistener()\r\n\t\t}\r\n\t}, []);\r\n\treturn [state.data, state.loading, state.error]\r\n}\r\n\r\nexport const AdminContext = createContext<[Role | undefined, boolean, firebase.auth.Error | undefined]>([undefined, true, undefined])\r\nexport const AdminProvider = ({ children }: { children: any }) => {\r\n\tconst [auth, isLoading, error] = _useAdmin()\r\n\treturn <AdminContext.Provider value={[auth, isLoading, error]}> {children} </AdminContext.Provider>\r\n}\r\n\r\nexport const useAdmin = (): [Role | undefined, boolean, firebase.auth.Error | undefined] => {\r\n\treturn useContext(AdminContext)\r\n}\r\n\r\n\r\n// Admin\r\nexport const AdminProviderContext = createContext<[Provider | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\nexport const AdminProviderProvider = ({ children }: { children: any }) => {\r\n\tconst [auth, waiting] = useAdmin()\r\n\tconst [data, isLoading, error] = useDocumentListen<Provider>(Provider, auth?.id ? new Provider(auth.id).documentReference : undefined, waiting)\r\n\treturn <AdminProviderContext.Provider value={[data, isLoading, error]}> {children} </AdminProviderContext.Provider>\r\n}\r\n\r\nexport const AdminProviderProductContext = createContext<[Product | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\nexport const AdminProviderProductProvider = ({ id, children }: { id: string, children: any }) => {\r\n\tconst [provider, waiting] = useContext(AdminProviderContext)\r\n\tconst documentReference = (provider && id) ? provider?.products.collectionReference.doc(id) : undefined\r\n\tconst [data, isLoading, error] = useDocumentListen<Product>(Product, documentReference, waiting)\r\n\treturn <AdminProviderProductContext.Provider value={[data, isLoading, error]}> {children} </AdminProviderProductContext.Provider>\r\n}\r\n\r\nexport const AdminProviderProductSKUContext = createContext<[SKU | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\nexport const AdminProviderProductSKUProvider = ({ id, children }: { id: string, children: any }) => {\r\n\tconst [product, waiting] = useContext(AdminProviderProductContext)\r\n\tconst documentReference = (product && id) ? product.skus.collectionReference.doc(id) : undefined\r\n\tconst [data, isLoading, error] = useDocumentListen<SKU>(SKU, documentReference, waiting)\r\n\treturn <AdminProviderProductSKUContext.Provider value={[data, isLoading, error]}> {children} </AdminProviderProductSKUContext.Provider>\r\n}\r\n\r\nexport const AdminProviderOrderContext = createContext<[Order | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\nexport const AdminProviderOrderProvider = ({ id, children }: { id?: string, children: any }) => {\r\n\tconst [provider, waiting] = useContext(AdminProviderContext)\r\n\tconst documentReference = (provider && id) ? provider.orders.collectionReference.doc(id) : undefined\r\n\tconst [data, isLoading, error] = useDocumentListen<Order>(Order, documentReference, waiting)\r\n\treturn <AdminProviderOrderContext.Provider value={[data, isLoading, error]}> {children} </AdminProviderOrderContext.Provider>\r\n}\r\n\r\nexport const useAdminProvider = (): [Provider | undefined, boolean, Error | undefined] => {\r\n\treturn useContext(AdminProviderContext)\r\n}\r\n\r\nexport const useAdminProviderProducts = (): [Product[], boolean, Error?] => {\r\n\tconst [provider, waiting] = useAdminProvider()\r\n\tconst collectionReference = provider ? provider.products.collectionReference : undefined\r\n\treturn useDataSourceListen<Product>(Product, { path: collectionReference?.path }, waiting)\r\n}\r\n\r\nexport const useAdminProviderProduct = (): [Product | undefined, boolean, Error | undefined] => {\r\n\treturn useContext(AdminProviderProductContext)\r\n}\r\n\r\nexport const useAdminProviderProductSKUs = (id?: string): [SKU[], boolean, Error?] => {\r\n\tconst [provider, waiting] = useAdminProvider()\r\n\tconst collectionReference = (provider && id) ? provider.products.collectionReference.doc(id).collection('skus') : undefined\r\n\treturn useDataSourceListen<SKU>(SKU, { path: collectionReference?.path }, waiting)\r\n}\r\n\r\nexport const useAdminProviderOrders = (): [Order[], boolean, Error?] => {\r\n\tconst [provider, waiting] = useAdminProvider()\r\n\tconst collectionReference = provider ? provider.orders.collectionReference : undefined\r\n\treturn useDataSourceListen<Order>(Order, { path: collectionReference?.path }, waiting)\r\n}\r\n\r\nexport const useAdminProviderProductSKU = (productID?: string, skuID?: string): [SKU | undefined, boolean, Error?] => {\r\n\tconst [provider, waiting] = useAdminProvider()\r\n\tconst documentReference = (provider && productID && skuID) ? provider.products.doc(productID, Product).skus.collectionReference.doc(skuID) : undefined\r\n\treturn useDocumentListen<SKU>(SKU, documentReference, waiting)\r\n}\r\n\r\nexport const useAdminProviderOrder = (id?: string): [Order | undefined, boolean, Error?] => {\r\n\tconst [provider, waiting] = useAdminProvider()\r\n\tconst documentReference = (provider && id) ? provider.orders.collectionReference.doc(id) : undefined\r\n\treturn useDocumentListen<Order>(Order, documentReference, waiting)\r\n}\r\n\r\n\r\n// User\r\nexport const UserContext = createContext<[User | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\nexport const UserProvider = ({ children }: { children: any }) => {\r\n\tconst [auth, waiting] = useContext(AuthContext)\r\n\tconst [user, isLoading, error] = useDocumentListen<User>(User, auth?.uid ? new User(auth.uid).documentReference : undefined, waiting)\r\n\treturn <UserContext.Provider value={[user, isLoading, error]}> {children} </UserContext.Provider>\r\n}\r\n\r\nexport const RolesContext = createContext<[Role[], boolean, Error | undefined]>([[], true, undefined])\r\nexport const RolesProvider = ({ children }: { children: any }) => {\r\n\tconst [user, waiting] = useContext(UserContext)\r\n\tconst [roles, isLoading, error] = useDataSourceListen<Role>(Role, user ? {\r\n\t\tpath: user.providers.collectionReference.path\r\n\t} : undefined, waiting)\r\n\treturn <RolesContext.Provider value={[roles, isLoading, error]}> {children} </RolesContext.Provider>\r\n}\r\n\r\nexport const CartContext = createContext<[Cart | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\nexport const CartProvider = ({ children }: { children: any }) => {\r\n\tconst [auth, waiting] = useContext(AuthContext)\r\n\tconst [cart, isLoading, error] = useDocumentListen<Cart>(Cart, auth?.uid ? new Cart(auth.uid).documentReference : undefined, waiting)\r\n\treturn <CartContext.Provider value={[cart, isLoading, error]}> {children} </CartContext.Provider>\r\n}\r\n\r\nexport const useUserShipping = (id?: string): [Shipping | undefined, boolean, Error | undefined] => {\r\n\tconst [auth, isAuthLoading] = useContext(AuthContext)\r\n\tconst collectionReference = new User(auth?.uid).shippingAddresses.collectionReference\r\n\tconst [ref] = useState(id ? collectionReference.doc(id) : collectionReference.doc())\r\n\tconst [shipping, isLoading, error] = useDocumentListen<Shipping>(Shipping, ref, isAuthLoading)\r\n\treturn [shipping, isLoading, error]\r\n}\r\n\r\nexport const useUserShippingAddresses = (): [Shipping[], boolean, Error | undefined] => {\r\n\tconst [auth, isAuthLoading] = useContext(AuthContext)\r\n\tconst collectionReference = new User(auth?.uid).shippingAddresses.collectionReference\r\n\tconst [data, isLoading, error] = useDataSourceListen<Shipping>(Shipping, { path: collectionReference?.path }, isAuthLoading)\r\n\treturn [data, isLoading, error]\r\n}\r\n\r\nexport const useCart = (): [Cart | undefined, boolean, Error | undefined] => {\r\n\treturn useContext(CartContext)\r\n}\r\n\r\nexport const useUser = (): [User | undefined, boolean, Error | undefined] => {\r\n\treturn useContext(UserContext)\r\n}\r\n\r\nexport const useRoles = (): [Role[], boolean, Error | undefined] => {\r\n\treturn useContext(RolesContext)\r\n}\r\n\r\n// Provider\r\n\r\n// export const ProviderContext = createContext<[Provider | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\n// export const ProviderProvider = ({ id, children }: { id?: string, children: any }) => {\r\n// \tconst [provider, isLoading, error] = useDocumentListen<Provider>(Provider, id ? new Provider(id).documentReference : undefined)\r\n// \treturn <ProviderContext.Provider value={[provider, isLoading, error]}> {children} </ProviderContext.Provider>\r\n// }\r\n\r\n// export const ProviderProductContext = createContext<[Product | undefined, boolean, Error | undefined]>([undefined, true, undefined])\r\n// export const ProviderProductProvider = ({ id, children }: { id?: string, children: any }) => {\r\n// \tconst [provider, waiting] = useContext(ProviderContext)\r\n// \tconst [product, isLoading, error] = useDocumentListen<Product>(Product, id ? provider?.products.collectionReference.doc(id) : undefined, waiting)\r\n// \treturn <ProviderProductContext.Provider value={[product, isLoading, error]}> {children} </ProviderProductContext.Provider>\r\n// }\r\n\r\n// export const useProvider = (): [Provider | undefined, boolean, Error | undefined] => {\r\n// \treturn useContext(ProviderContext)\r\n// }\r\n\r\n// export const useProviderProduct = (): [Product | undefined, boolean, Error | undefined] => {\r\n// \treturn useContext(ProviderProductContext)\r\n// }\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}